<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>杭州学区地图 · 查询与管理后台</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Source+Han+Sans+SC:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <p class="brand__tag">2025 杭州义务教育数据</p>
      <h1>杭州学区快速查询</h1>
      <p class="brand__desc">左侧地图实时切换小学 / 初中学区，右侧同步展示覆盖小区与对口学校，支持后台在线维护数据。</p>
    </div>
    <div class="stage-tabs" id="stageTabs" role="tablist" aria-label="学区阶段切换">
      <button type="button" data-stage="小学" class="active" role="tab" aria-selected="true">小学学区</button>
      <button type="button" data-stage="初中" role="tab" aria-selected="false">初中学区</button>
    </div>
    <button class="ghost-button" id="scrollAdmin" type="button">打开管理后台</button>
  </header>

  <main class="main-layout">
    <section class="map-panel">
      <div class="panel-card">
        <div class="panel-card__toolbar">
          <label>
            <span>行政区筛选</span>
            <select id="districtFilter">
              <option value="all">全部区域</option>
            </select>
          </label>
          <label>
            <span>关键词</span>
            <input id="keywordInput" type="search" placeholder="输入学区 / 小区 / 学校" autocomplete="off">
          </label>
          <div class="toolbar-stats">
            <span class="toolbar-stats__value" id="zoneCount">0</span>
            <span>可视学区</span>
          </div>
        </div>
        <div id="mapGrid" class="map-grid" role="region" aria-live="polite" aria-label="杭州市学区示意图"></div>
        <p class="panel-card__hint">点击色块可高亮学区并在右侧查看详情，再次点击可取消选择。</p>
      </div>
    </section>

    <section class="info-panel" id="infoPanel">
      <article class="info-card">
        <header class="info-card__header">
          <p class="chip" id="infoStage">小学</p>
          <h2 id="infoTitle">请选择一个色块</h2>
          <p id="infoSubtitle">地图中颜色越深代表优先级越高，选择后可查看该片区的政策提醒与覆盖小区。</p>
        </header>
        <dl class="info-meta">
          <div>
            <dt>行政区</dt>
            <dd id="infoDistrict">-</dd>
          </div>
          <div>
            <dt>政策提醒</dt>
            <dd id="infoPolicy">-</dd>
          </div>
        </dl>
        <section class="list-block">
          <div class="list-head">
            <h3>覆盖小区 / 楼盘</h3>
            <span id="communityCount">0 个</span>
          </div>
          <ul id="communityList" class="pill-list"></ul>
        </section>
        <section class="list-block">
          <div class="list-head">
            <h3>对应学校</h3>
            <span id="schoolCount">0 所</span>
          </div>
          <ul id="schoolList" class="school-list"></ul>
        </section>
      </article>
    </section>
  </main>

  <section class="admin-panel" id="adminSection">
    <div class="admin-bar">
      <div>
        <p class="brand__tag">数据管理</p>
        <h2>后台维护学区与小区</h2>
        <p class="brand__desc">支持新增 / 编辑 / 删除学区信息，数据自动缓存到浏览器本地。</p>
      </div>
      <button id="collapseAdmin" class="ghost-button" type="button" aria-expanded="true">收起后台</button>
    </div>
    <div class="admin-content" id="adminContent">
      <form id="zoneForm" class="admin-form">
        <input type="hidden" id="zoneId">
        <div class="form-row">
          <label>学区名称
            <input type="text" id="zoneNameInput" required placeholder="如：西湖 · 紫金港学军圈">
          </label>
          <label>行政区
            <input type="text" id="zoneDistrictInput" required placeholder="西湖区">
          </label>
          <label>阶段
            <select id="zoneStageInput" required>
              <option value="小学">小学</option>
              <option value="初中">初中</option>
            </select>
          </label>
        </div>
        <div class="form-row">
          <label>地图主色（HEX）
            <input type="text" id="zoneColorInput" required placeholder="#4c7dff">
          </label>
          <label>政策提醒
            <input type="text" id="zonePolicyInput" required placeholder="人户一致优先 / 名额分配等">
          </label>
          <label>一句话描述
            <input type="text" id="zoneDescInput" required placeholder="概述片区特点">
          </label>
        </div>
        <div class="form-row">
          <label>地图列（1-4）
            <input type="number" id="zoneColStartInput" min="1" max="4" value="1">
          </label>
          <label>列跨度
            <input type="number" id="zoneColSpanInput" min="1" max="2" value="1">
          </label>
          <label>地图行（1-4）
            <input type="number" id="zoneRowStartInput" min="1" max="4" value="1">
          </label>
          <label>行跨度
            <input type="number" id="zoneRowSpanInput" min="1" max="2" value="1">
          </label>
        </div>
        <label>覆盖小区（每行一个，可加备注：小区名|别名）
          <textarea id="zoneCommunitiesInput" rows="3" placeholder="黄龙世纪苑|西溪校区&#10;天目山庄"></textarea>
        </label>
        <label>直配学校（格式：学校名|阶段|说明）
          <textarea id="zoneSchoolsInput" rows="3" placeholder="学军小学紫金港|小学|集团本部&#10;文二教育集团|小学|科技特色"></textarea>
        </label>
        <div class="form-actions">
          <button type="submit" class="primary-btn">保存 / 更新</button>
          <button type="button" id="resetForm" class="ghost-button">清空表单</button>
        </div>
      </form>

      <div class="admin-table-wrapper">
        <table id="zoneTable">
          <thead>
            <tr>
              <th>学区</th>
              <th>阶段</th>
              <th>行政区</th>
              <th>小区数</th>
              <th>学校数</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <script src="script.js" defer></script>
</body>
</html>
